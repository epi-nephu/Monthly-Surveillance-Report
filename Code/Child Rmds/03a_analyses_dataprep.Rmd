
```{r}
# Conditions with at least one notification during three-year post-COVID lookback period
conditions_list <- cases_allnephu %>%
  dplyr::filter(reporting_group == conditions) %>%
  dplyr::filter(event_yearmonth >= epimonth_current - months(35)) %>% 
  #
  dplyr::group_by(condition_label) %>%
  dplyr::summarise(n = n()) %>%
  dplyr::ungroup() %>%
  #
  pull(condition_label)

last_row <- length(conditions_list)
```


```{r}
# High vs. low volume conditions during three-year post-COVID lookback period
volume_high <- cases_allnephu %>% 
  dplyr::mutate(condition_label = factor(condition_label,
                                         levels = conditions_list)) %>%
  #
  dplyr::filter(condition_label %in% conditions_list) %>%
  dplyr::filter(event_yearmonth >= epimonth_current - months(36) & event_yearmonth < epimonth_current) %>% 
  #
  dplyr::group_by(condition_label) %>% 
  dplyr::summarise(n = n()) %>%
  dplyr::ungroup() %>% 
  #
  tidyr::complete(condition_label,
                  fill = list(n = 0)) %>% 
  #
  dplyr::mutate(mean = n / 3,
                #
                condition_label = as.character(condition_label)) %>% 
  #
  dplyr::filter(mean >= high_volume) %>% 
  #
  pull(condition_label)

volume_low <- cases_allnephu %>% 
  dplyr::mutate(condition_label = factor(condition_label,
                                         levels = conditions_list)) %>%
  #
  dplyr::filter(condition_label %in% conditions_list) %>%
  dplyr::filter(event_yearmonth >= epimonth_current - months(36) & event_yearmonth < epimonth_current) %>% 
  #
  dplyr::group_by(condition_label) %>% 
  dplyr::summarise(n = n()) %>%
  dplyr::ungroup() %>% 
  #
  tidyr::complete(condition_label,
                  fill = list(n = 0)) %>% 
  #
  dplyr::mutate(mean = n / 3,
                #
                condition_label = as.character(condition_label)) %>% 
  #
  dplyr::filter(mean < high_volume) %>% 
  #
  pull(condition_label)
```

