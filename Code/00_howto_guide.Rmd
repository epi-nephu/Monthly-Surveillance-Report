---
title: 'NEPHU Monthly Surveillance Report - How-To Guide'
author_details: "Alana Little, NEPHU (alana.little@austin.org.au)"
version_details: "v1.0, 11/04/2024"
output: 
  html_document:
    code_folding: none
    toc: true
    toc_depth: 3
    toc_float: true
    self_contained: true
knit: (function(input, ...) {
  rmarkdown::render(input, output_file = "Monthly Surveillance Report How-To Guide", output_dir = "../") })
---

```{css, echo = FALSE}
/* */ 
.main-container {
    max-width: 850px;
}

h1.title {
  display: none;
}

h1 {
  font-weight: bold;
  font-size: 18px;
  color: #191D43;
}

h2 {
  font-weight: bold;
  font-size: 16px;
  color: #5BC788;
}

h3 {
  font-weight: bold;
  font-size: 14px;
}

body {
  font-size: 14px;
}

li > ul {
  margin-bottom: 10px;
}
```


```{r, echo = FALSE}
# Change log
# v1.0: First version
```


```{r, echo = FALSE, message = FALSE}
#
knitr::opts_chunk$set(echo    = FALSE, 
                      warning = FALSE, 
                      message = FALSE,
                      #
                      fig.align  = 'center')

options(knitr.kable.NA = '--')

here::i_am("Code/00_howto_guide.Rmd")
```


```{r, out.width = '850px'}
#
knitr::include_graphics(here::here("Screenshots", "title_banner.PNG"))
```

<!-- # Report Production Overview -->

<!-- > Insert handy flowchart here -->

<!-- *** -->

# Purpose of Monthly Reporting

* The NEPHU Monthly Surveillance Report is a retrospective epidemiological review of notifications received during the previous complete calendar month.

    * Provide a summary of notification data for all notifiable conditions managed by NEPHU.
    
    * Identify and analyse long-term notification trends.
    
    * Identify potential special-cause variation.
    
* Reporting is restricted to confirmed and/or probable cases (except for AMR).

* The number of notifications for a condition will fluctuate from month to month and from year to year – this is known as **normal variation**. We can expect, predict, and quantify this variation.

* For public health surveillance and monitoring, we are interested in unexpected or unusual variations – this is known as **special cause variation**.

* Special cause variation may be due to:

    * Outbreaks,
    
    * Emergence of drug-resistant strains of pathogens,
    
    * Mutation of pathogens to be more severe or more transmissible,
    
    * Breakdowns in health infrastructure or public health measures.

* Special cause variation can be harder to predict, but we can look for signals that it is occurring.

* This report uses three methods to identify potential special cause variation:

    * [Modified historical limits method.](https://www.ncbi.nlm.nih.gov/pmc/articles/PMC4313630/)
    
    * [Control charts](https://cran.r-project.org/web/packages/qicharts2/vignettes/qicharts2.html) reviewed using the Western Electric and Anhøj rules.
    
    * Identification of rare conditions that have not been notified in NEPHU during the previous 6-12 months.

<br/>

***

# A Step-by-Step Guide to Running the NEPHU Monthly Surveillance Report

## Part 1: Getting the Data

### Getting started

Using Windows Explorer, navigate to the **Monthly Surveillance Report folder** on the shared drive.

```{r, out.width = '800px'}
#
knitr::include_graphics(here::here("Screenshots", "folder_shareddrive.PNG"))
```

<br/>

Download the required PHESS extracts for the month and save them in the **../Data subfolder**. YYYYMMDD is the last day of the previous calendar month.

```{r, out.width = '800px'}
#
knitr::include_graphics(here::here("Screenshots", "folder_data.PNG"))
```

<br/>

### Notifiable diseases data

***AMR notifications (year to date)***

* Maven Reporting > NEPHU Reports > AMR case linelist

* Report period start date: 01 January of current calendar year

* Report period end date: Last day of previous calendar month

* Output type: Excel

* Rename file to **AMRCaseLinelist_YYYYMMDD**
    
At the start of each calendar year a new historical dataset will need to be prepared. Refer to Appendix 1 for more information about how to do this.

```{r, out.width = '400px'}
#
knitr::include_graphics(here::here("Screenshots", "phess_amr.PNG"))
```

<br/>

***NEPHU cases (year to date)***

* Maven Reporting > NEPHU Reports > NEPHU Case Linelist

* Report period start date: 01 January of current calendar year

* Report period end date: Last day of previous calendar month

* Output type: Excel

* Rename file to **NEPHUCaseLinelist_YYYYMMDD**
    
At the start of each calendar year a new historical dataset will need to be prepared. Refer to Appendix 1 for more information about how to do this.

```{r, out.width = '400px'}
#
knitr::include_graphics(here::here("Screenshots", "phess_nephu.PNG"))
```

<br/>

***Victorian influenza cases (previous calendar month)***

* Maven Reporting > NEPHU Reports > VictoriaLinelist1

* Report period start date: First day of previous calendar month

* Report period end date: Last day of previous calendar month

* Output type: Excel

* Rename file to **VictoriaLinelist1_YYYYMMDD**

```{r, out.width = '400px'}
#
knitr::include_graphics(here::here("Screenshots", "phess_victoria1.PNG"))
```

<br/>

***Victorian cases of other conditions (previous calendar month)***

* Maven Reporting > NEPHU Reports > VictoriaLinelist2

* Report period start date: First day of previous calendar month

* Report period end date: Last day of previous calendar month

* Output type: Excel

* Rename file to **VictoriaLinelist2_YYYYMMDD**

```{r, out.width = '400px'}
#
knitr::include_graphics(here::here("Screenshots", "phess_victoria2.PNG"))
```

<br/>

***Victorian cases of selected high-volume conditions (previous calendar month)***

* Maven Reporting > NEPHU Reports > VictoriaLinelist3

* Report period start date: First day of previous calendar month

* Report period end date: Last day of previous calendar month

* Output type: Excel

* Rename file to **VictoriaLinelist3_YYYYMMDD**

```{r, out.width = '400px'}
#
knitr::include_graphics(here::here("Screenshots", "phess_victoria3.PNG"))
```

<br/>

### Reference data

In addition to the PHESS extracts, there are also three reference documents/files required. These don't need to be updated each month.

```{r, out.width = '800px'}
#
knitr::include_graphics(here::here("Screenshots", "folder_reference.PNG"))
```

<br/>

***Conditions reference list***

* This is a manual list maintained by the NEPHU Epidemiology and Intelligence Team

* Contains information about each notifiable condition

* This will need to updated if conditions are added/removed from the notifiable diseases list

* **../Data/Reference/ConditionsReferenceList.xlsx**

```{r, out.width = '800px'}
#
knitr::include_graphics(here::here("Screenshots", "data_conditions.PNG"))
```

<br/>

***LGA populations***

* This is a manual list maintained by the NEPHU Epidemiology and Intelligence Team

* Contains population data for each LGA in Victoria (2021 Census)

* **../Data/Reference/LGAAllocationLong.xlsx**

```{r, out.width = '600px'}
#
knitr::include_graphics(here::here("Screenshots", "data_population.PNG"))
```

<br/>

***Shapefiles***

* These files contain digital boundaries for each LGA in Australia, and are used to create maps

* The shapefiles can be downloaded from the [ABS website](https://www.abs.gov.au/statistics/standards/australian-statistical-geography-standard-asgs-edition-3/jul2021-jun2026/access-and-downloads/digital-boundary-files)

* The current file used is "Local Government Areas - 2022 - Shapefile", found in the "Non ABS Structures" section

    * This file has been downloaded and unzipped to the ../Data subfolder

```{r, out.width = '800px'}
#
knitr::include_graphics(here::here("Screenshots", "data_shapefile.PNG"))
```

<br/>

***
    
## Part 2: Monthly Data Prep

### Getting started

Using Windows Explorer, navigate to the **Monthly Surveillance Report folder** on the shared drive.

```{r, out.width = '800px'}
#
knitr::include_graphics(here::here("Screenshots", "folder_shareddrive.PNG"))
```

<br/>

Open the R Project file **Monthly Surveillance Report.Rproj** from Windows Explorer.

```{r, out.width = '800px'}
#
knitr::include_graphics(here::here("Screenshots", "folder_rproject.PNG"))
```

<br/>

Open **01.data_prep_monthly.R** using the Files tab in RStudio.

```{r, out.width = '600px'}
#
knitr::include_graphics(here::here("Screenshots", "code_dataprep.PNG"))
```

<br/>

### What does this code do?

* Installs and loads the R packages required to run the Internal and External Reports

* Defines the reporting month and year

* Calculates all of the month and year related variables required for the Internal and External Reports

* Reads in and wrangles all of the datasets required for the Internal and External Reports

<br/>

### Updating the data prep code

Update the following parameters in the code:

* epimonth_current = First day of the previous calendar month in the format YYYY-MM-DD

* extract_date = Date you extracted the data from PHESS in the format YYYY-MM-DD

```{r, out.width = '600px'}
#
knitr::include_graphics(here::here("Screenshots", "code_epimonthcurrent.PNG"))
```

<br/>

What year is it? Is it still 2025? If so, you don't need to do anything else. The code is smart enough to calculate everything else you need.

If you're reading this in the future, update the following parameters in the code:

* filedate_ytd = The year range for the historical datasets created at the start of the year in the format YYYY_YYYY

* ytd_current = The current year in the format YYYY

You will also need to update the historical datasets when a new year starts. Refer to Appendix 1 for details on how to do this.

```{r, out.width = '600px'}
#
knitr::include_graphics(here::here("Screenshots", "code_ytdcurrent.PNG"))
```

<br/>

Again, the code is clever enough to do all of the other date calculations you need. Nifty!

Save your changes to **01.data_prep_monthly.R**

```{r, out.width = '600px'}
#
knitr::include_graphics(here::here("Screenshots", "code_savechanges.PNG"))
```

<br/>

***

## Part 3: Running the Internal Report

### Getting started

Navigate to the **Monthly Surveillance Report folder** on the shared drive.

```{r, out.width = '800px'}
#
knitr::include_graphics(here::here("Screenshots", "folder_shareddrive.PNG"))
```

<br/>

If not already done, open the R Project file **Monthly Surveillance Report.Rproj** from Windows Explorer.

```{r, out.width = '800px'}
#
knitr::include_graphics(here::here("Screenshots", "folder_rproject.PNG"))
```

<br/>

Open **02_monthly_surveillance_report_internal.Rmd** using the Files tab in RStudio.

```{r, out.width = '600px'}
#
knitr::include_graphics(here::here("Screenshots", "folder_internal.PNG"))
```

<br/>

### What does this code do?

* Quite a lot honestly!

* Reads in and runs 01_data_prep_monthly.R

* Runs a standard set of analyses for every condition, and displays the results in a html document

* Uses for loops and conditional logic to read in and run specific child documents (analyses) based on whether there have been any cases of the condition during the lookback period, whether it is a high or low volume condition, and whether we have sufficient historical data available to calculate means and expected case numbers

* Uses functions to apply standard data prep, analysis, and formatting for charts and tables

<br/>

The child documents can be found in the **../Child Rmds subfolder**:

* 02a_analyses_dataprep.Rmd = creates lists containing the required variables for each condition in the reporting group

* 02b_analyses_table.Rmd = creates and formats the notification summary table

* 02c_analyses_summary_highvolume.Rmd = creates and formats the summary charts for each high volume condition (for conditions where sufficient historical data are available)

* 02c_analyses_summary_lowvolume.Rmd = creates and formats the summary charts for each low volume condition (for conditions where sufficient historical data are available)

* 02c_analyses_summary_nohistorical.Rmd = creates and formats the summary charts for each condition (for conditions where sufficient historical data are not available)

* 02d_analyses_detailed_highvolume.Rmd = creates and formats the detailed charts for each high volume condition (for conditions where sufficient historical data are available)

* 02d_analyses_detailed_lowvolume.Rmd = creates and formats the detailed charts for each low volume condition (for conditions where sufficient historical data are available)

* 02d_analyses_detailed_nohistorical.Rmd = creates and formats the detailed charts for each condition (for conditions where sufficient historical data are not available)

* 02d_analyses_nocases.Rmd = creates a narrative text statement for conditions where there were no cases during the lookback period

```{r, out.width = '600px'}
#
knitr::include_graphics(here::here("Screenshots", "folder_child.PNG"))
```

<br/>

The functions can be found in the **../Functions subfolder**:

* f_create_bar.R = creates and formats bar charts

* f_create_map.R = creates and formats notification rate maps

* f_create_pyramid.R = creates and formats age pyramids

* f_create_ribbon.R = creates and formats ribbon charts

* f_create_table.R = creates and formats notification summary tables

```{r, out.width = '600px'}
#
knitr::include_graphics(here::here("Screenshots", "folder_function.PNG"))
```

<br/>

### Updating and running the code

Update the two circled parameters in the YAML header of the document to the reporting month.

```{r, out.width = '600px'}
#
knitr::include_graphics(here::here("Screenshots", "code_internalyaml.PNG"))
```

<br/>

Knit the document. Depending on your R installation you may need to select ‘html’ in a dropdown menu that appears when you click on the Knit button. The code should take about 6-8 minutes to run, and the .Rmd will be automatically saved when it is knitted.

```{r, out.width = '600px'}
#
knitr::include_graphics(here::here("Screenshots", "code_internalknit.PNG"))
```

<br/>

If everything has worked as intended you should now have a html file in the **../Reports subfolder** titled **Monthly Surveillance Report YYYY MM Internal** (YYYY MM is the reporting month).

```{r, out.width = '800px'}
#
knitr::include_graphics(here::here("Screenshots", "folder_internalreport.PNG"))
```

<br/>

***

## Part 4: Reviewing the Internal Report

### Notification summary tables

Review each of the tables in the report, and make a note of the following:

*	Conditions that are higher than expected for this time of year (<span style="color: red;">red</span>)

```{r, out.width = '800px'}
#
knitr::include_graphics(here::here("Screenshots", "report_higher.PNG"))
```

<br/>

* Conditions that do not have sufficient historical data for comparison (*italics*) – do they appear to be higher or lower than expected based on the data we do have available?

```{r, out.width = '800px'}
#
knitr::include_graphics(here::here("Screenshots", "report_newconditions.PNG"))
```

<br/>

### Summary charts

Review each of the summary charts, and make a note of the following:

* Data point for the reporting month outside of the expected range (grey area)

```{r, out.width = '600px'}
#
knitr::include_graphics(here::here("Screenshots", "report_outsiderange.PNG"))
```

<br/>

* Sustained runs of data points above the mean

```{r, out.width = '600px'}
#
knitr::include_graphics(here::here("Screenshots", "report_sustainabove.PNG"))
```

<br/>

* Notifications where the previous notification was more than 6-12 months ago

```{r, out.width = '600px'}
#
knitr::include_graphics(here::here("Screenshots", "report_rarecondition.PNG"))
```

<br/>

### What does it all mean?

For each condition you've noted review the tables, summary charts, and detailed analyses.

* How does NEPHU compare to Victoria?

* How does this month/YTD compare to last month/YTD?

* Do the age, sex, and LGA distributions align with what you’d expect?

* Are there any genders, age groups, or LGAs where the number of notifications is higher or lower than expected?

* Are there any genders, age groups, or LGAs where the number of notifications is increasing or decreasing over time?

* How does this align with what you know about the priorities/workload of the Health Protection team over the past month?

* What is happening with this condition in other Victorian LPHUs? Across Australia? Internationally?

Note: the detailed analyses charts show the number of notifications for each subgroup over time. Use caution when comparing numbers between different subgroups (e.g. across LGAs) as the population of these subgroups may be different.

<br/>

***

## Part 5: Running the External Report

### Getting started

Navigate to the **Monthly Surveillance Report folder** on the shared drive.

```{r, out.width = '800px'}
#
knitr::include_graphics(here::here("Screenshots", "folder_shareddrive.PNG"))
```

<br/>

If not already done, open the R Project file **Monthly Surveillance Report.Rproj** from Windows Explorer.

```{r, out.width = '800px'}
#
knitr::include_graphics(here::here("Screenshots", "folder_rproject.PNG"))
```

<br/>

Open **03_monthly_surveillance_report_external.Rmd** using the Files tab in RStudio.

```{r, out.width = '600px'}
#
knitr::include_graphics(here::here("Screenshots", "folder_external.PNG"))
```

<br/>

### What does this code do?

* Reads in and runs 01_data_prep_monthly.R

* Uses child documents to create standard bar charts for the conditions in the Epidemiological Highlights section and standard tables for each reporting group in the Notifications Summary Table section

* Uses functions to apply standard data prep, analysis, and formatting for charts and tables

* Creates a html document consisting of the following sections:

    * Introductory text and Table of Contents
    * Chief Health Officer Alerts and Advisories
    * Epidemiological Highlights
    * Other Conditions of Note
    * Clinical Feature
    * Notifications Summary Table for all conditions
    * Technical Notes

<br/>

The child documents can be found in the **../Child Rmds subfolder**:

* 03a_analyses_dataprep.Rmd = creates lists containing the required variables for each condition in the reporting group

* 03b_analyses_table.Rmd = creates and formats the notification summary table

<br/>

The functions can be found in the **../Functions subfolder**:

* f_create_bar.R = creates and formats bar charts

* f_create_table.R = creates and formats notification summary tables

<br/>

### Updating the code

Update the two circled parameters in the YAML header of the document to the reporting month.

```{r, out.width = '600px'}
#
knitr::include_graphics(here::here("Screenshots", "code_externalyaml.PNG"))
```

<br/>

The NEPHU Medical Team will prepare the content for the Clinical Feature section of the external report and send it through to the Epi Inbox by the 7th of each month. When you know the topic, update the following parameter in the code:

* clinical_feature = title/topic of Clinical Feature

```{r, out.width = '600px'}
#
knitr::include_graphics(here::here("Screenshots", "code_clinicalfeature.PNG"))
```

<br/>

Much of the standard text in the report (e.g. Technical Notes) will remain the same from month to month, or is automatically updated through the magic of R and RMarkdown.

<br/>

***Table of contents***

* Update the content (text inside [] brackets) and links (text inside () brackets) as required. Generally, the only lines that will need updating are the specific conditions you will be including in the Epidemiological Highlights section.

```{r, out.width = '600px'}
#
knitr::include_graphics(here::here("Screenshots", "external_toc.PNG"))
```

<br/>

***Chief Health Officer Alerts and Advisories***

* Update the content (text inside [] brackets) and links (text inside () brackets) in this section as required

* Include CHO Alerts and Advisories issued between the start of the reporting month to the day you are sending the final approved report to Comms

```{r, out.width = '600px'}
#
knitr::include_graphics(here::here("Screenshots", "external_cho.PNG"))
```

<br/>

***Epidemiological Highlights***

* Select conditions to include in this section based on the information you've abstracted from the Internal Report

* Whether or not to include a condition is a subjective choice - generally if a condition is highlighted in the notification summary table as higher than expected and the control charts suggest possible special cause variation I will include it here or in the Other Conditions of Note section

* The review process includes asking Epi, Med, and HP TLs whether they agree with the conditions included in this section

<br/>

Each condition included in this section gets its own subsection, using a standard format:
   
* A bar chart of the number of notifications per month for the past 12 months

* Dot points summarising the epidemiology of the condition in NEPHU

* Dot points containing information about the condition, such as national/international trends, diagnosis, testing, or risk factors

* Links to additional resources - include the Victorian Department of Health: Control Guidelines and Advice and Better Health Channel links as a minimum

* The review process includes asking Epi, Med, and HP TLs whether they have any suggestions for content/links
   
<br/>

Update the following parameters in the code for each condition of interest:

* condition_name = the condition of interest

* data_count = leave this as results_count

* figure_number = start with Figure 1

* figure_title = can be the same as the condition_name, but allows for abbreviations to be used

* ymax = maximum value for the y-axis (recommend using ymax = 5 for conditions with <5 notifications every month, otherwise use ymax = NA)

* ybreaks = spacing between tick marks on the y-axis

* yexpand = additional white space padding above the y-axis maximum value

ymax, ybreaks, and yexpand values are matters of personal preference. Try different values and see what looks best to you.

```{r, out.width = '600px'}
#
knitr::include_graphics(here::here("Screenshots", "code_barchart.PNG"))
```

<br/>

Write the content for the dot points as text outside of a code chunk using Markdown syntax. See the existing examples in previous reports for inspiration.

```{r, out.width = '600px'}
#
knitr::include_graphics(here::here("Screenshots", "external_text.PNG"))
```

<br/>

You can add as many conditions as you want/need to this section - copy and modify the code from a previous condition.

<br/>

***Other Conditions of Note***

* Select conditions to include in this section based on the information you've abstracted from the Internal Report

* Each condition in this section is summarised in one dot point (and subpoints if required) - these conditions don't require the same depth of detail or analysis as those included in the Epidemiological Highlights section

* The review process includes asking Epi, Med, and HP TLs whether they agree with the conditions included in this section

Write the content for the dot points as text outside of a code chunk using Markdown syntax. See the existing examples in previous reports for inspiration.

```{r, out.width = '600px'}
#
knitr::include_graphics(here::here("Screenshots", "external_other.PNG"))
```

<br/>

***Clinical Feature***

* The NEPHU Medical Team will prepare the content for the Clinical Feature section of the report and send it through to the Epi Inbox by the 7th of each month

* The content will come through as a Word document. Use Markdown syntax to add the content from the Word document into the report - see the existing examples in previous reports for inspiration

* The Clinical Feature is wrapped in an infobox - content beween the **::: infobox** and **:::** will be inside a green bordered box in the external report html

```{r, out.width = '600px'}
#
knitr::include_graphics(here::here("Screenshots", "external_feature.PNG"))
```

<br/>

***Notifications Summary Table***

* This section should automatically update each month - no additional changes are routinely required

* If needed, write the content for the dot points as text outside of a code chunk using Markdown syntax - see the existing examples in previous reports for inspiration

* The code reads in child documents (03a_analyses_dataprep.Rmd and 03b_analyses_table.Rmd) and produces the notification summary table for each reporting group

* Conditions are only included in these tables if there has been at least one notification in NEPHU during the report lookback period

```{r, out.width = '600px'}
#
knitr::include_graphics(here::here("Screenshots", "external_table.PNG"))
```

<br/>

***Technical Notes***

* This section should automatically update each month - no additional changes are routinely required

* If needed, write the content for the dot points as text outside of a code chunk using Markdown syntax - see the existing examples in previous reports for inspiration

```{r, out.width = '600px'}
#
knitr::include_graphics(here::here("Screenshots", "external_technical.PNG"))
```

<br/>

### Running the code

Knit the document. Depending on your R installation you may need to select ‘html’ in a dropdown menu that appears when you click on the Knit button. The external report runs a lot more quickly than the internal report (as it doesn't contain a billion graphs), and should take a couple of minutes to run.

```{r, out.width = '600px'}
#
knitr::include_graphics(here::here("Screenshots", "code_externalknit.PNG"))
```

<br/>

If everything has worked as intended you should now have a html file in the **../Reports subfolder** titled **Monthly Surveillance Report YYYY MM External** (YYYY MM is the reporting month).

```{r, out.width = '800px'}
#
knitr::include_graphics(here::here("Screenshots", "folder_externalreport.PNG"))
```

<br/>

## Part 6: Surveillance Meeting Presentation

We present a Monthly Update at the NEPHU Whole of Team Surveillance and Outbreak Meeting, usually on the second Thursday of each month. The content for this presentation comes from the Epidemiological Highlights and Other Conditions of Note that you've selected for inclusion in the external report.

Slides from previous presentations and a template slide deck can be found in the **../Presentations subfolder**.

```{r, out.width = '800px'}
#
knitr::include_graphics(here::here("Screenshots", "folder_presentation.PNG"))
```

<br/>

Save a copy of the template in the **../Presentations subfolder**, using the file name **Epi Highlights - YYYY MM**.

```{r, out.width = '800px'}
#
knitr::include_graphics(here::here("Screenshots", "presentation_savelocation.PNG"))
```

<br/>

Update the highlighted sections in Slides 1 and 3 with the reporting month and date of data extraction from PHESS. 

```{r, out.width = '800px'}
#
knitr::include_graphics(here::here("Screenshots", "presentation_date.PNG"))
```

<br/>

Create a slide for each **Epidemiological Highlight** condition you wish to include. The dot points on the slide will generally be a high level summary of the epidemiology of the condition in NEPHU, any subgroups with higher than expected notifications, how NEPHU compares to Victoria, and contextual information about what is happening statewide/nationally/internationally.

The template contains examples for a high-volume condition (pertussis), a condition without historical data (rotavirus), and an AMR condition (CPE). 

```{r, out.width = '800px'}
#
knitr::include_graphics(here::here("Screenshots", "presentation_highlight.PNG"))
```

<br/>

The **Other Conditions of Note** are summarised on 1-2 slides. The template contains an example.

```{r, out.width = '800px'}
#
knitr::include_graphics(here::here("Screenshots", "presentation_other.PNG"))
```

<br/>

***

## Part 7: Reviewing and Finalising the Report

### Disseminating for feedback

Congratulations! You now have a draft report. The next step is for the draft report to be reviewed and (hopefully) approved. However, while html files look lovely they are not very easy to edit or add comments to. We will create a Word version of the report to allow people to make comments.

* Right-click on **Monthly Surveillance Report YYYY MM External.html** and select Open With > Word

* Turn Track Changes on

* Select File > Save As

* Change the File Type to Word Document (*docx)

* Change the File Name to **Monthly Surveillance Report YYYY MM External v1**

* Save the file in the **For Review subfolder**

```{r, out.width = '600px'}
#
knitr::include_graphics(here::here("Screenshots", "review_savelocation.PNG"))
```

<br/>

Links to the draft report (Word and html versions) are sent via email to the NEPHU Epi Team, NEPHU Med Team, NEPHU HP TLs, HP Senior Manager, and Population Health Senior Manager. We usually give everyone two full business days to provide comments.

```{r, out.width = '600px'}
#
knitr::include_graphics(here::here("Screenshots", "review_email.PNG"))
```

<br/>

### Incorporating feedback

* Review the comments and update **03_monthly_surveillance_report_external.Rmd** accordingly

* Knit the updated .Rmd and save a Word version (v2) in the For Review subfolder

* Links to the draft report (Word and html versions) are sent via email to the Epi and Intelligence Lead and Med/Epi Senior Manager for approval, and the NEPHU Director and Senior Epidemiologist are cc'd for awareness

* Approval will be received via email from the Med/Epi Senior Manager

```{r, out.width = '600px'}
#
knitr::include_graphics(here::here("Screenshots", "review_approval.PNG"))
```

<br/>

### Sending the report to Comms

We're almost there! The external report has now been approved and can be sent out to our stakeholders and published on the NEPHU website. The NEPHU Comms team handle this part of the process for us - we just need to give them a file they can work with.

* Previously Comms used a program called Vision6 for newsletter mailouts, they now use a program called Mailchimp

* Comms maintain the distribution list for us - the NEPHU website and each edition of the Monthly Surveillance Report contains instructions for signing up to the mailing list

* Mailchimp (and Vision6) emails cannot contain attachments - any information we send out needs to be within the content of the external report (narrative text, charts, tables, hyperlinks)

<br/>

The report needs to be sent to Comms as a .txt file for Mailchimp (or Vision6) to interpret and format it correctly. Fun fact - a .html file is just a very fancy .txt file!

* Right-click on **Monthly Surveillance Report YYYY MM External.html** and select Open With > Notepad

* Select File > Save As

* Change the File Name to **Monthly Surveillance Report YYYY MM External Mailchimp**

* Make sure that the File Type is Text Document (*.txt) - this should be the default

* Make sure that the Encoding is UTF-8 - this should be the default

* Save the file in the **Sent to Comms subfolder**

```{r, out.width = '600px'}
#
knitr::include_graphics(here::here("Screenshots", "comms_txtfile.PNG"))
```

<br/>

The txt version of the report is sent as an attachment via email to the NEPHU Comms Team.

```{r, out.width = '600px'}
#
knitr::include_graphics(here::here("Screenshots", "comms_email.PNG"))
```

<br/>

The Comms Team will usually send through a test email to make sure that everything is displaying correctly. If all goes well, the report will be scheduled to go out in the following few days. Ideally, the report will be sent out on a Monday morning.

The final step is to wait for the report to arrive in your inbox, open it, have a final read through, and admire your hard work.

```{r, out.width = '600px'}
#
knitr::include_graphics(here::here("Screenshots", "comms_finalreport.PNG"))
```

<!-- # Appendix 1: Historical Data Prep -->

<!-- > Add content here -->

<!-- *** -->

<!-- # Appendix 2: Conditional Logic Flowcharts -->

<!-- > Add content here -->

<!-- *** -->

<br/>

<div class="tocify-extend-page" data-unique="tocify-extend-page" style="height: 0;"></div>
